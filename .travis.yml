language: go
go:
- 1.11
before_script:
- sudo apt-get install -qq sshpass
script: 
after_success:
- sshpass -p $SSH_PASS ssh -o StrictHostKeyChecking=no $SSH_USER@$SSH_HOST rm ~/server/game
- sshpass -p $SSH_PASS scp -rp -o stricthostkeychecking=no * $SSH_USER@$SSH_HOST:~/server/game
- sshpass -p $SSH_PASS ssh -o StrictHostKeyChecking=no $SSH_USER@$SSH_HOST docker
  build -t game-server ~/server/game
- sshpass -p $SSH_PASS ssh -o StrictHostKeyChecking=no $SSH_USER@$SSH_HOST docker
  stop game
- sshpass -p $SSH_PASS ssh -o StrictHostKeyChecking=no $SSH_USER@$SSH_HOST docker
  run -e "DB_HOST=postgres" -e "DB_USER=$DB_USER" -e "JWT_TOKEN=$JWT_TOKEN" -e "DB_PASS=$DB_PASS"
  -e "DB_DB=$DB_DB" -d --link postgres:postgres --publish 4040:8080 -v /var/www/html/avatars:/go/src/github.com/go-park-mail-ru/2018_2_LSP_GAME/avatars/
  --name game --rm game-server
env:
  global:
  - secure: WyuV7rBA16gzbHevbXC/zP7+eDb4ieqLEkzUG2tsOkVihEYO0WHauL8A2RkRhrEylkxCDPcLvKajA9HRudai2WmfQzwYavQ3XyLusgnYj2ZZfT6i6K+wWBx2wHloS2WLLIpFhjhYPhnODR+uzvbdf6n4pKoESV/feufTepWYpHfGrNQRT8gnEm92PtOYFFRRV0VsCahYrcjgQEif5RHxcz1SDoanUhmSN3reryx6oFXMaIoi5on/roSl6X8OkrOkBMc9QkNlOnrzs/TRUKGHs0nRMEJZV4LwDxDK77HG4H0HIKbAq0qOVxNhdHKFZ9P0h+34fW/+ExdskDBdUsYxCoZUZeahaED1b5AsyRwEF6ZNyJQarIpjqFbLrcBj7twtOJrtuMT0mMZ8pcmn5RWNObs2XlWPUP8ZE5wSfqigCrVySjxQDmsI7411IaH2Zf4fS/ITfMkxsZSyNYWcduept1iwvBzjOAROhG7xJUkPcSeVfllwFjtn643rLbURLj/veZZPir1UXqyIdxdSp4YNb7KhSYgSbcsXfzv9kvrv4H0Kk3rBn78BuA1PrTDeODfc1ECSzvQ1dRJj/xK6WFA9wu3xhOwH/CQcUqHT78agOlmYrymA7xrDkwYIX6mHareWWd8COx9O5wjyIEgbs3ISeY3nWZzKF5zy0L+ffUfvzUk=
  - secure: W77wI29WPhXepTR7rHFnBZ4SAMsM3GKrERxZLGGGK6e9aQ1AM/5VjgcfbKskM73Q1QvCke1h7DULW+kwI1Y1090rsBtGZci7LYUE+RBNMVf71W6T5aX1WFKvBY7i33pgfxblJ+0y8oDJ45DbLhdfjnuqHjPoTwm4BM3kF/qwGmzOVhuep3JkGQDoEZ06XEeJNpCfrZwMy9D8KAKEYSh/3IyDiH1RejSizFLMRTcf0XCIb1xl20G7zwJtdvLw9XnXNcSEFNDYhJWz9Y5RGm6sqcE+wS2+tpjfU+GirvRB2M8NwIcihMvVr43+hNGMlWykBvqE8FKpKLNDESfrIrea5qR77SjtSTwH3TwEuezQWZnaQhcNA24M7rUOTKV5NAs0wtF/wSDHy1JtiGTSqVOJzfc8rtlm9HLHJ2L/pGQumIvYr1CeVyA2Biqv8O+Jd01kZe1RRGvIjEkJobklh2OetMMdpLPgtoXzWMXDyA6vlEKLeSTqqB88xiOiLf1klgB5nThQHkBfFniw64Zl0UR8jyRdFHjPyOTmnBZD9TIVrwu+In502xJJYE5Kj0Odq5iU/+GJOZSCHWs+YJslhM4S2v4NmQM5ll2vql8KIrc0yoGmzKAx6kGykvbxa11qtxVVTVsy3Y4b94JF8SiekNv0r8khiilQZgZMUHaadkI9jQk=
  - secure: LijQtfuWUDF9EiFe9Ls74xb2cll7/yXL06V6BJO/mZ1ktEutCKgNp+/NglG0hn2OwLpwAG2Q4yCC0R8Byl+pxqU1mr9bQeke2j+vrtF197xy03KrokOpzbAwlS27qniAA/00x3RNED7IVZLzyXNNRPI8S5TMI7yIjWVVtCHmcQIq3WDI57tv6JhwC1pPqilIK33FlYga5bW9lznLuS7gqticK5pgJc0/pAynn142xqguvU0/fC3/cQYFLlbY0n3/Y5lHA2787RQpmTvDmO+CZxmMhe26XH802lHWnSBqpNhg8+6dlZ7d4NrcIzUT1UwX8/KMSOEOiRO+rE3vwvJIuwaLRhsYDtz3x01seJADedQztSRZJRNCmPVx55LHzghALKLz7tSJNlfBhwldOQPkweMijLokGbeH/3k0AmjLGYqDesA+PnQ5B4pIwikNA6DQmp7RzvucyImyFTpRAP371n0b8MLxnT5xjdTc5RyHZfjiGt3OcwPmizZXtjDcIosStds3/lLemuVYz7ykVQNNrJiO6gSFWt3XoZsd0z5VIDilvS6cHH11u//4lzHSKrYEazOhgIEanwzCw2L01zIRCxrEz79dFr9gUw2WUlWZ6yKqQF7/3ZCc20wwETAHsO+b9T03Cz1Ao9CqAMGssvzv4AY4NAaqgOK6xDL56bqW7wU=
  - secure: HT32GWLbXLxMRzL8mh37/HuFu7BPc4CcmexT84I2t5n70kz9oh1oNnL2/UWK7PM3YzWNL/Pla3N6dsTDPd8XfF+k4S3ZfcGhqAMVezfmu9Xho5msAdTtg2Pq+Aw6Pb4GyjksIy+JiF9Us+oGfEgKkQpxTkCzxvs2h+tDXbnHK3kcwEgLmGHnKqq8HBt+MY8hgJqgyqTTca1vg95T7QYQT/B7RfZN9v8gCuEChLwyXoSEkZQUqtprpL0f64gEDRXwGoe0mjfUCrvtz5VI8EkOtTQgaDD1PfG8uq2OxY4MTOcuKKlNKitZmPU4UTVNShgNX+TSpqPkMufSjTKmjRIgJIPJ+vG1DAbYdsyojGk+pHSWYo3rJlhvnVsB078PNtQeqJQ/0HdJekNWL8H+YJZN5v3uhNQdbi7iGPSHA90Xc8pAdvXcGyJMpl2ALmBAdGylIJqdqPKIEcK8jZlPdd3DmbvbKWIRLq+O6bL/ECwkwmWjULhHOsbao1tCCiLD+Y27YoaOLICtE8FiS/tO9RMagqEKmPfepM+jKiyL6wbB0FjRCq/mM/MZN0Y8uesA/AJzSsFZvmjX8NxvJNnJuA8+hvfImMGNz6s+qBw0gNiKmr4S5yrUQt8Svb4R5knvdSPB35XPm+NK+deQoZgUIOfggwvmNoUBiH1s/n6QYoZkQmE=
  - secure: VH+d7aXW98512ivgwtzZ7r1zhHzPCO8IRhqmZIcgrF2bOxwqfD3vZCAJTCYw4oBLSgaa+4no2AADfK/lNdbzFt24C6QWvL118GGIALLVHYQwfUeVU1UCd8JH7dG38VqzxcHD6sOwpPTbV4tkJJlZw8/8er1NsgrME/Sp4FRH/pr1FVjBBBZsil7zoZlfP9hrtxFBGKwqdceZjNkL+KhltkSWegNga9sVunGBNiMXr3CKu4TRu0mZAdwlTI/n4RXiDoJxVCHg55g16ZgAWl3qma2sCYcvl4geL946RyNMHF5nxsmqAls2Jw2NhPsEpL18Psrz/4XzdKryeZromMa+bFqZ8cugHib5OaAcyuFBpo8FqOk/7pe/nUpJpaimRopMXWSM1MSMQX9HKFMNL3Xl5sQkWlDml2M43uQuKii8LwBsKXAMwGk3Hdi396AI/a7tbzZrT+4gardfn0n9tNWFvTmHz+OdZktwYbXJdtjLt5H5Rz+X1csKyIR51luRC7hePrCm8s7Uus5GjR3sxbRxKzaRaJaRDlLhzI72BcNX7zzXhR/LMd3lZlFnS3oYKUnpnuk/WlO5o3LInGkVWb9vxUJ+Jb1d/O5GhvcgUim1qG2QoK1e4WJYF5tAhmEZyQ2SHJFYtMt9rjATsVLJfwL+65RUo5q9POjck+89kJisYmA=
  - secure: utaiiDDFlupmBfRzCKjbtlQRhyjWH3xDA4njmgQrdifMwvDCtJOvae29RYLeuc2tZ+cKeEWH04eC6Ip2pAy9QZKUCn5mCC2DqUDZOPoztMpD0cbghMUgnmqmfvcAcTJXbKgKk9p6+CZSGAgY8THSnbP0knohQ+96VlF+tXPBiX+QZ4SED/qI7LeqzYEt8DEBYLPh2H0dDh7QjEQgoOAz9wvJhir4B/hf/KBxORM/qSjaxkSB/5bwTmNdfbcUFIWuW1pzWgQvuGXgqa2yvPL5g6HsQ53dMfYi5M7Ditu0MNaOmk1c/DMahIDZ7guOBethDjLog9rjVxYMDMT69asCys9+QfTN1Ql8PRAfJhij7DNtgWAolEbS/lQ54MPgnfLDYcolCxodFW1bMgg26TXN2VesojS0MpOaWxW3gs5o+an1wsGBxC4pPLv3+F8eDAKDFRQ59xMCbc60z8ESP02aZCsx6SmI0yplpaWXlum409i5Za0ZqhT8nWTPQi33K3T/ELQcufrKVnZF73zbdeCClmiNOuntDQmZ+LJUyIsfrC/DYkIwNdCgZbMR2EBzxDkS7tVrlgwyqn94ycC4YtCbVeXA68RYfqyczQ7o3n9y27exgOJ687/h0h+K/thMtAVQhhGtVbCwW7N9zQ6llMgq+STjQoFFQb/wYB0NDnTTSbQ=
  - secure: ix48hZxOEDC3Ox10XUa8WuDGSJvhzlLbfzC0l4jZn4X/o8PmFZ783olAPtStSFNTf3IfaBI3bGlakOKpMNdze6iRq7FC2E4DlvemQE+CGKVgdRuTWaNT8/REDWKUeDsNfyIDgh44zbBjjJh2Hk7C9oTBVyq+3cmrpvDeplOK2i5zfOKtLCdOkVsWwj/ks5oJxdqhpc4TM2XOHMh9eLgDomomfXnTcz38V994osoG+CSIUG8b7K5VakEr88uJ8i8RbRyjdQGFneOcugiaCLPLecHr0htZKWea1/LaRL9Jd4rjGVchYoGAqe40Wj6UmNvfeMvszQoBQRXhiRC8Y/LAI9F095HiCUkv0LU6FaYbtVaKzrCTGBpQry7W3KP4i/jsLG+7fYjAs14Q0bspzyoF2AHDEHrrFIQaB+HOgGXooIJ+5sGovb6S66EbCjAYZiR2LaEZruokDP3W0zUso98O4Krh/peGEzLiwH2lPdmFk4qD1e++R7d+qCtC7Yv7RdgJfZdKJQBRNo04Qi7R6xBxwY4sUchx35wbc7ZM6zU1hJjSHiV8aXZuZ+xHzYmhNrkFr+dT5Vch5/7/gLq4gIW0CgVKEP8tHyrCdOWvCKTMPvnb/kVkMPGCPPwqx2DlQTG+KfEqnscZA4EPEfTIh+/ebizRMmxbJ3iwBQZDTHuluV4=
  - secure: CnFXkOBvTqR21XtfIqV3KUxypwleXF/8cDvpbT4/5DyaxXhaFT3wHRyGbkWpoJtti2HO9rfHnK0Yi2jvLzx/mUghyNPRu1QzSxSCTqI5T6zwNz52lch9FmS/mQX+/7ElG+pgn7kIcLbfAlQmxAdNWKTAP/Ty29erEBb8n9lygkqHNmp7YZ3d3cr5sSjhWUMW2m/IL93iF2x2IN+lw6Hv+VERvqCkPqehTWdyeXpE9K96c7bdJyjSpVsr5W3vvvhQYTeL6tp5GtnK5djNKRpa55bGOJuOERc/TvTOH8c0xFsvJfINmHUgOItzn5odgAtdV+DAnGqISk62Ass0jyK4FQPQ197KEOoKb7Qz2izx7V1FAlnAwsvm0KpUVIeD76A+ZUKnWaPUuiefZBAoIpu/dOQuEgmqukAQ6A4W1SI23gI/E6zARkqgPcbL1pfu8/09xeNc/zw8ZXSvH4veAyErnVsEZyXCM84DLLdV9hnhSvuAwaKImhAkRsgw6nQttsw0r15QOeC5mmH4oSgYT/iyc4hVsfizUB08MSn7ZXXlDFvULmv1v7m2s27jK9EdNdR3aL0wLbY10CoA+9XUcJ1FxBKu1ClrtnvlSxguxXrvpMna4uPUyhnl/dyrc6qIf69VB6oOQoURPVzIWd4Z9cjVaGppWLxT5QMxBnXfaaf0ZdI=
